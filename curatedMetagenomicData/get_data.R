library("curatedMetagenomicData")

datatypes <- list("relative_abundance", "pathway_abundance")
root_folder <- "/Users/fabio/GitHub/MicroBiomML/curatedMetagenomicData/"

datasets <- list("2021-03-31.AsnicarF_2017",
                "2021-10-14.AsnicarF_2017",
                "2021-03-31.AsnicarF_2021",
                "2021-03-31.BackhedF_2015",
                "2021-10-14.BackhedF_2015",
                "2021-03-31.Bengtsson-PalmeJ_2015",
                "2021-10-14.Bengtsson-PalmeJ_2015",
                "2021-03-31.BritoIL_2016",
                "2021-03-31.BrooksB_2017",
                "2021-10-14.BrooksB_2017",
                "2021-03-31.Castro-NallarE_2015",
                "2021-03-31.ChengpingW_2017",
                "2021-10-14.ChengpingW_2017",
                "2021-03-31.ChngKR_2016",
                "2021-04-02.ChuDM_2017",
                "2021-03-31.CosteaPI_2017",
                "2021-10-14.CosteaPI_2017",
                "2021-03-31.DavidLA_2015",
                "2021-03-31.DeFilippisF_2019",
                "2021-03-31.DhakanDB_2019",
                "2021-03-31.FengQ_2015",
                "2021-03-31.FerrettiP_2018",
                "2022-04-13.FrankelAE_2017",
                "2021-03-31.GhensiP_2019",
                "2021-03-31.GopalakrishnanV_2018",
                "2021-10-14.GopalakrishnanV_2018",
                "2021-03-31.GuptaA_2019",
                "2021-03-31.HallAB_2017",
                "2021-10-14.HallAB_2017",
                "2021-03-31.HanniganGD_2017",
                "2021-03-31.HansenLBS_2018",
                "2021-10-14.HansenLBS_2018",
                "2021-03-31.Heitz-BuschartA_2016",
                "2021-03-31.HMP_2012",
                "2021-03-31.HMP_2019_ibdmdb",
                "2021-10-14.HMP_2019_ibdmdb",
                "2021-03-31.HMP_2019_t2d",
                "2021-03-31.IjazUZ_2017",
                "2021-10-14.IjazUZ_2017",
                "2021-03-31.JieZ_2017",
                "2021-10-14.JieZ_2017",
                "2021-03-31.KarlssonFH_2013",
                "2021-10-14.KarlssonFH_2013",
                "2021-03-31.KaurK_2020",
                "2021-10-14.KaurK_2020",
                "2021-03-31.KeohaneDM_2020",
                "2021-03-31.KieserS_2018",
                "2021-10-14.KieserS_2018",
                "2021-03-31.KosticAD_2015",
                "2021-03-31.LassalleF_2017",
                "2021-03-31.LeChatelierE_2013",
                "2022-04-13.LeeKA_2022",
                "2021-03-31.LifeLinesDeep_2016",
                "2021-03-31.LiJ_2014",
                "2021-03-31.LiJ_2017",
                "2021-10-14.LiJ_2017",
                "2021-04-02.LiSS_2016",
                "2021-03-31.LiuW_2016",
                "2021-10-14.LiuW_2016",
                "2021-03-31.LokmerA_2019",
                "2021-10-14.LokmerA_2019",
                "2021-03-31.LomanNJ_2013",
                "2021-03-31.LoombaR_2017",
                "2021-10-14.LoombaR_2017",
                "2021-03-31.LouisS_2016",
                "2021-03-31.MatsonV_2018",
                "2021-10-14.MatsonV_2018",
                "2021-03-31.MehtaRS_2018",
                "2021-10-14.MehtaRS_2018",
                "2021-03-31.NagySzakalD_2017",
                "2021-10-14.NagySzakalD_2017",
                "2021-03-31.NielsenHB_2014",
                "2021-03-31.Obregon-TitoAJ_2015",
                "2021-03-31.OhJ_2014",
                "2021-10-14.OhJ_2014",
                "2021-03-31.OlmMR_2017",
                "2021-03-31.PasolliE_2019",
                "2021-04-02.PehrssonE_2016",
                "2021-10-14.PehrssonE_2016",
                "2022-04-13.PetersBA_2019",
                "2021-03-31.QinJ_2012",
                "2021-10-14.QinJ_2012",
                "2021-03-31.QinN_2014",
                "2021-03-31.RampelliS_2015",
                "2021-03-31.RaymondF_2016",
                "2021-03-31.RosaBA_2018",
                "2021-10-14.RosaBA_2018",
                "2021-03-31.RubelMA_2020",
                "2021-10-14.RubelMA_2020",
                "2021-03-31.SankaranarayananK_2015",
                "2021-03-31.SchirmerM_2016",
                "2021-03-31.ShaoY_2019",
                "2021-03-31.ShiB_2015",
                "2021-10-14.ShiB_2015",
                "2021-03-31.SmitsSA_2017",
                "2021-03-31.TettAJ_2016",
                "2021-03-31.TettAJ_2019_a",
                "2021-03-31.TettAJ_2019_b",
                "2021-03-31.TettAJ_2019_c",
                "2021-03-31.ThomasAM_2018a",
                "2021-03-31.ThomasAM_2018b",
                "2021-03-31.ThomasAM_2019_c",
                "2021-03-31.VatanenT_2016",
                "2021-03-31.VilaAV_2018",
                "2021-03-31.VincentC_2016",
                "2021-03-31.VogtmannE_2016",
                "2021-03-31.WampachL_2018",
                "2022-04-13.WindTT_2020",
                "2021-03-31.WirbelJ_2018",
                "2021-03-31.XieH_2016",
                "2021-03-31.YachidaS_2019",
                "2021-10-14.YachidaS_2019",
                "2021-03-31.YassourM_2016",
                "2021-03-31.YassourM_2018",
                "2021-03-31.YeZ_2018",
                "2021-03-31.YuJ_2015",
                "2021-03-31.ZeeviD_2015",
                "2021-03-31.ZellerG_2014",
                "2021-03-31.ZhuF_2020")

for (dataset_id in datasets) {
    for (datatype in datatypes) {
        dataset <- paste(dataset_id, ".", datatype, sep="")

        outpath <- paste(root_folder, datatype, sep="")

        cmddata <- curatedMetagenomicData(dataset, dryrun=FALSE, counts=FALSE, rownames="long")
        cmddata_matrix <- cmddata[[dataset]]@assays@data@listData
        cmddata_matrix <- cmddata_matrix[[datatype]]
        cmddata_matrix <- as.data.frame(t(cmddata_matrix))
        write.table(cmddata_matrix, paste(outpath, "/", dataset, ".tsv", sep=""), sep="\t", row.names=TRUE)
    }
}
